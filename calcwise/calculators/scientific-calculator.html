<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO -->
    <title>Scientific Calculator - CalcWise</title>
    <meta name="description" content="Free online scientific calculator. Solves trigonometry, logarithms, exponents, and basic math. Mobile-friendly dark mode interface.">
    
    <!-- Fonts & Styles -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css">
    
    <!-- Page Specific Styles -->
    <style>
        .scientific-wrapper {
            max-width: 450px;
            margin: 0 auto;
        }

        /* The Screen */
        .calc-display {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: right;
            margin-bottom: 1.5rem;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .history-text {
            display: block;
            color: var(--text-secondary);
            font-size: 0.9rem;
            min-height: 1.2rem;
            margin-bottom: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .current-text {
            display: block;
            color: var(--text-primary);
            font-size: 2.5rem;
            font-weight: 500;
            font-family: 'JetBrains Mono', monospace;
            word-wrap: break-word;
        }

        /* The Grid */
        .keypad {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.8rem;
        }

        /* Buttons */
        .key {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            font-size: 1.2rem;
            padding: 1.2rem 0;
            border-radius: 10px;
            cursor: pointer;
            user-select: none;
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .key:hover {
            background: var(--bg-input);
            border-color: var(--text-brand);
        }

        .key:active { transform: scale(0.96); }

        /* Button Types */
        .key.op {
            color: var(--text-brand);
            font-weight: 600;
            background: rgba(59, 80, 209, 0.05);
        }

        .key.func {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .key.clear {
            color: #e74c3c; /* Red for Delete */
            background: rgba(231, 76, 60, 0.1);
            border-color: rgba(231, 76, 60, 0.2);
        }

        .key.equal {
            grid-column: span 2;
            background: var(--btn-primary);
            color: #ffffff;
            border: none;
            box-shadow: 0 4px 12px rgba(59, 80, 209, 0.3);
        }
        .key.equal:hover { background: #2a40b0; }

        @media (max-width: 500px) {
            .current-text { font-size: 2rem; }
            .key { padding: 1rem 0; }
        }
    </style>
</head>
<body>

    <!-- =========================================
       GLOBAL HEADER
       ========================================= -->
    <header class="site-header">
        <div class="container nav-inner">
            <a href="../index.html" class="brand-logo">
                <span style="color: var(--btn-primary);">Calc</span>Wise
            </a>

            <div class="search-wrapper">
                <svg class="search-icon-left" width="16" height="16" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <input type="text" id="global-search" class="search-input" placeholder="Search tools..." aria-label="Search calculators">
                <span class="search-shortcut">⌘ K</span>
            </div>

            <button id="theme-toggle" class="theme-btn" aria-label="Toggle Dark Mode">
                <svg class="icon-moon" width="20" height="20" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="display: none;">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
                <svg class="icon-sun" width="20" height="20" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
            </button>
        </div>
    </header>

    <!-- =========================================
       CALCULATOR UI
       ========================================= -->
    <main class="main-content container">
        
        <!-- Breadcrumbs -->
        <div style="margin: 2rem 0 1rem; font-size: 0.85rem; color: var(--text-secondary);">
            <a href="../index.html">Home</a> <span style="margin:0 5px;">/</span> Math <span style="margin:0 5px;">/</span> Scientific Calculator
        </div>

        <section class="glass-panel" style="padding: 2rem;">
            <div class="scientific-wrapper">
                
                <!-- Display -->
                <div class="calc-display">
                    <span id="history" class="history-text"></span>
                    <span id="current" class="current-text">0</span>
                </div>

                <!-- Keypad -->
                <div class="keypad">
                    <!-- Row 1 -->
                    <button class="key clear" onclick="clearAll()">AC</button>
                    <button class="key func" onclick="deleteChar()">DEL</button>
                    <button class="key op" onclick="appendOp('%')">%</button>
                    <button class="key op" onclick="appendOp('/')">÷</button>

                    <!-- Row 2 -->
                    <button class="key func" onclick="appendFunc('sin')">sin</button>
                    <button class="key func" onclick="appendFunc('cos')">cos</button>
                    <button class="key func" onclick="appendFunc('tan')">tan</button>
                    <button class="key op" onclick="appendOp('*')">×</button>

                    <!-- Row 3 -->
                    <button class="key" onclick="appendNum('7')">7</button>
                    <button class="key" onclick="appendNum('8')">8</button>
                    <button class="key" onclick="appendNum('9')">9</button>
                    <button class="key op" onclick="appendOp('-')">-</button>

                    <!-- Row 4 -->
                    <button class="key" onclick="appendNum('4')">4</button>
                    <button class="key" onclick="appendNum('5')">5</button>
                    <button class="key" onclick="appendNum('6')">6</button>
                    <button class="key op" onclick="appendOp('+')">+</button>

                    <!-- Row 5 -->
                    <button class="key" onclick="appendNum('1')">1</button>
                    <button class="key" onclick="appendNum('2')">2</button>
                    <button class="key" onclick="appendNum('3')">3</button>
                    <button class="key func" onclick="appendFunc('sqrt')">√</button>

                    <!-- Row 6 -->
                    <button class="key" onclick="appendNum('0')">0</button>
                    <button class="key" onclick="appendNum('.')">.</button>
                    <button class="key equal" onclick="calculate()">=</button>
                </div>

                <!-- Discrete Donation (Centered below keypad) -->
                <div style="text-align: center; margin-top: 1.5rem;">
                    <a href="https://www.buymeacoffee.com" target="_blank" class="hidden-donate">
                        ☕ Value this tool? Support the dev.
                    </a>
                </div>

            </div>
        </section>
    </main>

    <!-- =========================================
       GLOBAL FOOTER
       ========================================= -->
    <footer class="site-footer">
        <div class="container">
            <p>
                &copy; 2024 CalcWise<br>
                Engineered by <a href="https://www.brainboxtoweb.tech/" target="_blank" class="agency-link">Brain Box to Web</a>
            </p>
        </div>
    </footer>

    <!-- Global Logic -->
    <script src="../assets/js/main.js"></script>

    <!-- Scientific Logic -->
    <script>
        const currentEl = document.getElementById('current');
        const historyEl = document.getElementById('history');
        
        let currentInput = '0';
        let previousInput = '';
        let operator = null;
        let shouldResetScreen = false;

        function updateScreen() {
            currentEl.textContent = currentInput;
        }

        function appendNum(num) {
            if (currentInput === '0' || shouldResetScreen) {
                currentInput = num;
                shouldResetScreen = false;
            } else {
                // Prevent multiple decimals
                if (num === '.' && currentInput.includes('.')) return;
                currentInput += num;
            }
            updateScreen();
        }

        function appendOp(op) {
            if (operator !== null) calculate();
            previousInput = currentInput;
            operator = op;
            historyEl.textContent = `${previousInput} ${convertOpSymbol(op)}`;
            shouldResetScreen = true;
        }

        function convertOpSymbol(op) {
            if (op === '*') return '×';
            if (op === '/') return '÷';
            return op;
        }

        function appendFunc(func) {
            let val = parseFloat(currentInput);
            if (isNaN(val)) return;
            
            switch(func) {
                case 'sin': currentInput = Math.sin(val).toFixed(6); break;
                case 'cos': currentInput = Math.cos(val).toFixed(6); break;
                case 'tan': currentInput = Math.tan(val).toFixed(6); break;
                case 'sqrt': 
                    if (val < 0) { currentInput = 'Error'; break; }
                    currentInput = Math.sqrt(val).toFixed(6); 
                    break;
            }
            // Remove trailing zeros
            if (currentInput !== 'Error') {
                currentInput = parseFloat(currentInput).toString();
            }
            shouldResetScreen = true;
            updateScreen();
        }

        function deleteChar() {
            if (shouldResetScreen) return;
            currentInput = currentInput.toString().slice(0, -1);
            if (currentInput === '') currentInput = '0';
            updateScreen();
        }

        function clearAll() {
            currentInput = '0';
            previousInput = '';
            operator = null;
            historyEl.textContent = '';
            updateScreen();
        }

        function calculate() {
            if (operator === null || shouldResetScreen) return;
            let a = parseFloat(previousInput);
            let b = parseFloat(currentInput);
            if (isNaN(a) || isNaN(b)) return;

            let result;
            switch (operator) {
                case '+': result = a + b; break;
                case '-': result = a - b; break;
                case '*': result = a * b; break;
                case '/': result = b === 0 ? 'Error' : a / b; break;
                case '%': result = a % b; break;
            }

            // Formatting
            if (result === 'Error') {
                currentInput = 'Error';
            } else {
                // Limit decimals for cleaner display
                currentInput = Math.round(result * 100000000) / 100000000;
                currentInput = currentInput.toString();
            }
            
            operator = null;
            historyEl.textContent = '';
            shouldResetScreen = true;
            updateScreen();
        }

        // Keyboard Logic
        document.addEventListener('keydown', (e) => {
            if (e.key >= 0 && e.key <= 9) appendNum(e.key);
            if (e.key === '.') appendNum('.');
            if (e.key === '=' || e.key === 'Enter') calculate();
            if (e.key === 'Backspace') deleteChar();
            if (e.key === 'Escape') clearAll();
            if (e.key === '+') appendOp('+');
            if (e.key === '-') appendOp('-');
            if (e.key === '*') appendOp('*');
            if (e.key === '/') appendOp('/');
        });
    </script>
</body>
</html>